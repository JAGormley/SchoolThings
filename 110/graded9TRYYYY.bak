;; The first three lines of this file were inserted by DrRacket. They record metadata
;; about the language level of this file in a form that our tools can easily process.
#reader(lib "htdp-intermediate-reader.ss" "lang")((modname graded9TRYYYY) (read-case-sensitive #t) (teachpacks ()) (htdp-settings #(#t constructor repeating-decimal #f #t none #f ())))
(define CUTOFF2 10)

(define (vkline2 p1 p2)
  (if (<= p1 p2)
      (list p1 p2)
      
      
      (local [(define A (sub1 p1))
              (define B (add1 p2))
              (define C (add1 p1))
              (define D (add1 p2))
              (define E (- p2 p1))]
                              
        (vkline2 A B))))

(vkline2 17 15)



(require 2htdp/image)



(define MTS (empty-scene 600 400))
(define CUTOFF 10)

;; Posn Posn -> Number
;; produce the distance between two points
(define (distance p1 p2)
  (sqrt (+ (sqr (- (posn-x p2) (posn-x p1)))
           (sqr (- (posn-y p1) (posn-y p1))))))

;; Posn Posn Img -> Image
;; add a black line from p1 to p2 on image
(define (simple-line p1 p2 img)
  (add-line img (posn-x p1) (posn-y p1) (posn-x p2) (posn-y p2) "black"))




;; Posn Posn Img -> Img


(define (vkline p1 p2 img)
  (if (<= (distance p1 p2) CUTOFF)
      (simple-line p1 p2 img)
      
      (local [(define A p1)
              
              (define B (make-posn (/ (distance p1 p2) 3)
                                   (posn-y p1)))
              (define C (make-posn (/ (distance p1 p2) 3)
                                   (- (posn-y p1)(/ (distance p1 p2) 3))))
              (define D (make-posn (* (distance p1 p2) 2/3)
                                   (- (posn-y p1)(/ (distance p1 p2) 3))))
              (define E (make-posn (* (distance p1 p2) 2/3 ) 
                                   (posn-y p1)))
              (define F p2)]
        
        (simple-line B C (vkline A B (simple-line D E (simple-line C D (simple-line E F img))))
                     
        ))))


(vkline (make-posn 5 300) (make-posn 580 300) MTS)